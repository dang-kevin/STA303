---
title: "Dungeness Crab Growth"
geometry: margin=1in
output:
  html_document:
    df_print: paged
header-includes:
- \usepackage{fontspec}
- \setmainfont{Times New Roman}
fontsize: 12pt
---

As Dungeness crabs grow, they need to replace their carapace; a process referred to as molting. My analysis involves grouping the adult female Dungeness crabs by whether they recently molted or not, estimating the mean carapace size of both groups, then determining whether there is a significant difference between the groups.
First, a *boxplot*[^8] of the shell size (`size`) by the shell type (`shell`) was created. Shell type 0 represents a fouled carapace which can be interpreted as an old shell, while shell type 1 represents a clean carapace -- a recently molted shell. The boxplot shows that older shells contain some outliers, while recent shells have no outliers. From the *summary statistics*[^9], type 0 shells are larger than type 1 shells by 7mm on average. 
A *two sample t-test*[^10] yielded a statistically significant p-value; this indicates that the means of the 2 groups are not equivalent. The two sample groups are independent,since the traps that were used were designed to catch adult female Dungeness crabs of all sizes, meaning that this sample is representative of the population. An *F-test to compare two variances*[^11] shows that the two sample group variances are similar -- the constant variance condition is met. Both the *Normal QQ Plot*[^12] and *Histogram of Shell Size*[^13] show skew in the data, which may be a problem. Fortunately, the sample size of 362 (161 type 0, 201 type 1) is sufficiently large. By the Central Limit Theorem, means of samples from a population approach a normal distribution as sample size increases -- regardless of the population distribution. Thus, the normality condition for the t-test is met.
Given the strong supporting evidence, adult female Dungeness crabs with older carapaces (shell type 0) on average have larger shells than those with recently molted carapaces (shell type 1).

[^8]: Boxplot of shell size by type
[^9]: Summary Statistics
[^10]: Two Sample t-test
[^11]: F test to compare two variances
[^12]: Normal QQ plot
[^13]: Histogram of Shell Size



## Crab Growth Data
```{r, crab-1, message=FALSE, warning=FALSE}
library(tidyverse)

# Load data
crab <- readr::read_table("https://www.stat.berkeley.edu/users/statlabs/data/crabpop.data",col_types = "dc")

glimpse(crab)

#Boxplot
crab %>%
  ggplot(aes(x=shell, y=size)) +
  theme_classic() +
  geom_boxplot() +
  labs(title="Boxplot of shell size by type",
       subtitle = "Crab Data",
       x = "Shell Type",
       y = "Shell Size"~(mm))

#Normal QQ
crab %>%
  mutate_at("size",funs( (. - mean(.)) / sd(.))) %>%
  arrange(size) %>%
  mutate(q = qnorm(1:n() / (n() + 1))) %>%
  ggplot(aes(x = q,y = size)) +
  theme_classic() +
  geom_point(pch=21) +
  geom_abline(slope = 1,intercept = 0,colour = "red") +
  labs(title = "Normal QQ-plot",
       subtitle = "Crab Data",
       x = "Theoretical Quantiles",
       y = "Sample Quantiles")

# Histogram
crab %>%
  ggplot(aes(x = size)) +
  theme_classic() +
  geom_histogram(aes(y = ..density..),colour="black",fill="lightblue",bins = 15) +
  geom_density(colour = "red") +
  labs(title = "Histogram of Shell Size",
       subtitle = "Crab Data",
       x = "Shell Size (mm)",
       y = "Density")

```

### Summary Statistics
```{r, crab-sum-1, message=FALSE, warning=FALSE}

group_means <- crab %>%
  group_by(shell) %>%
  summarize(group_mean = mean(size),
            group_median = median(size),
            group_sd = sd(size),
            group_size = n())
group_means

```

### Two Sample t-test
```{r, crab-test-2, message=FALSE, warning=FALSE}

t_test <- t.test(size ~ shell, data = crab, var.equal = TRUE)
t_test

```

### F test to compare two variances
```{r, crab-test-1, message=FALSE, warning=FALSE}

f_test <- var.test(size ~ shell, data = crab)
f_test

```

